{% extends "base.html" %}

{% block title %}Dashboard - BIST Tarayıcı{% endblock %}

{% block content %}
<div class="dashboard">
    <!-- Header -->
    <header class="dashboard-header">
        <div class="header-left">
            <h1>BIST Akümülasyon Tarayıcı</h1>
        </div>
        <div class="header-right">
            <div class="scan-info" id="scan-info">
                <span class="scan-date">Tarama bekleniyor...</span>
            </div>
            <button id="manual-scan-btn" class="btn btn-primary btn-sm" onclick="triggerManualScan()">
                <span id="scan-btn-text">Manuel Tarama</span>
            </button>
            <div class="user-menu">
                <span class="username">{{ current_user.username }}</span>
                <a href="{{ url_for('main.logout') }}" class="btn btn-secondary btn-sm">Çıkış</a>
            </div>
        </div>
    </header>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab-button active" data-tab="active">
            Aktif Bloklar <span id="active-count" class="badge">0</span>
        </button>
        <button class="tab-button" data-tab="completed">
            Tamamlanan Bloklar <span id="completed-count" class="badge">0</span>
        </button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
        <!-- Active Zones Tab -->
        <div id="active-tab" class="tab-pane active">
            <div class="section-header">
                <h2>Aktif Akümülasyon Bölgeleri</h2>
                <p class="section-description">Devam etmekte olan akümülasyon bölgeleri (skor 30+)</p>
                <div class="view-toggle">
                    <button class="toggle-btn active" data-view="treemap">Treemap</button>
                    <button class="toggle-btn" data-view="list">Liste</button>
                </div>
            </div>

            <div id="active-zones-container" class="zones-container">
                <div class="loading">Yükleniyor...</div>
            </div>
        </div>

        <!-- Completed Zones Tab -->
        <div id="completed-tab" class="tab-pane">
            <div class="section-header">
                <h2>Tamamlanan Bloklar (Son 3 Hafta)</h2>
                <p class="section-description">Biten veya kural dışı kalan akümülasyon bölgeleri</p>
            </div>

            <div id="completed-zones-container" class="zones-container">
                <div class="loading">Yükleniyor...</div>
            </div>
        </div>
    </div>

    <!-- Zone Detail Modal -->
    <div id="zone-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-body">
                <!-- Zone details will be loaded here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
<script src="{{ url_for('static', filename='js/treemap.js') }}"></script>
{% endblock %}
